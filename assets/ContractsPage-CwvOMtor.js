import{az as w,a as C,_ as S,av as V,t as c,v as s,x as n,E as b,y as a,z as p,a1 as f,a2 as y,a3 as q,A as i,F as u,K as U,B as k,D as _,aw as l,ax as D,a4 as Q}from"./index-B0B_lWYo.js";import{b as m}from"./QMenu-DFjdsKDI.js";import{Q as v,d as z,e as x}from"./selection-oSnWavsm.js";import{a as N,b as B,Q as F}from"./QBanner-Bm3h_6z2.js";import"./format-CnPgPtuC.js";const g=w("contractStore",{state:()=>({baseUrl:"95.217.214.37:5000",contracts:[],loading:!1,showDialog:!1,newContract:{supply_type:"",name:"",fiscal_code:"",supply_address:"",billing_address:"",client_code:"",contract_name:"",contract_code:"",consumption_since_start:"",power_available:"",supply_start_date:"",contract_end_date:"",billing_frequency:""}}),actions:{async fetchContracts(){this.loading=!0;try{const r=localStorage.getItem("token"),t=await C.get(`http://${this.baseUrl}/api/contracts`,{headers:{Authorization:`Bearer ${r}`}});this.contracts=t.data}catch(r){console.error("Error fetching contracts:",r)}finally{this.loading=!1}},async addContract(){try{const r=localStorage.getItem("token"),t=await C.post(`http://${this.baseUrl}/api/contracts`,this.newContract,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});this.contracts.push(t.data),this.closeDialog(),this.resetNewContract()}catch(r){console.error("Error adding contract:",r)}},openDialog(){this.showDialog=!0},closeDialog(){this.showDialog=!1},resetNewContract(){this.newContract={supply_type:"",name:"",fiscal_code:"",supply_address:"",billing_address:"",client_code:"",contract_name:"",contract_code:"",consumption_since_start:"",power_available:"",supply_start_date:"",contract_end_date:"",billing_frequency:""}}}}),I={name:"ContractsPage",data(){return{contractStore:g()}},computed:{contracts(){return this.contractStore.contracts},loading(){return this.contractStore.loading}},methods:{...V(g,["fetchContracts","addContract"]),saveContract(){this.contractStore.addContract()}},created(){this.fetchContracts()}};function A(r,t,T,h,o,d){return s(),c(Q,{class:"q-pa-md"},{default:n(()=>[t[18]||(t[18]=b("h4",{class:"text-center"},"Contratti",-1)),a(p,{color:"primary",label:"Nuovo Contratto",onClick:t[0]||(t[0]=e=>o.contractStore.openDialog()),class:"q-mb-md"}),d.contracts.length?(s(),c(v,{key:0,bordered:"",separator:""},{default:n(()=>[(s(!0),f(y,null,q(d.contracts,e=>(s(),c(z,{key:e._id},{default:n(()=>[a(x,null,{default:n(()=>[a(m,null,{default:n(()=>[i(u(e.contract_name),1)]),_:2},1024),a(m,{caption:""},{default:n(()=>[i("Cliente: "+u(e.name),1)]),_:2},1024),a(m,{caption:""},{default:n(()=>[i("Codice Cliente: "+u(e.client_code),1)]),_:2},1024),a(m,{caption:""},{default:n(()=>[i("Tipo: "+u(e.supply_type),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):d.loading?(s(),c(U,{key:1,color:"primary",size:"2em"})):(s(),c(N,{key:2,class:"bg-warning text-dark"},{default:n(()=>t[16]||(t[16]=[i(" Nessun contratto disponibile. ")])),_:1})),a(B,{modelValue:o.contractStore.showDialog,"onUpdate:modelValue":t[15]||(t[15]=e=>o.contractStore.showDialog=e)},{default:n(()=>[a(k,{style:{width:"450px"}},{default:n(()=>[a(_,null,{default:n(()=>t[17]||(t[17]=[b("div",{class:"text-h6"},"Aggiungi Nuovo Contratto",-1)])),_:1}),a(_,null,{default:n(()=>[a(F,{modelValue:o.contractStore.newContract.supply_type,"onUpdate:modelValue":t[1]||(t[1]=e=>o.contractStore.newContract.supply_type=e),label:"Tipo di Fornitura",options:["energy","gas"],class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.name,"onUpdate:modelValue":t[2]||(t[2]=e=>o.contractStore.newContract.name=e),label:"Nome Cliente",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.fiscal_code,"onUpdate:modelValue":t[3]||(t[3]=e=>o.contractStore.newContract.fiscal_code=e),label:"Codice Fiscale",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.supply_address,"onUpdate:modelValue":t[4]||(t[4]=e=>o.contractStore.newContract.supply_address=e),label:"Indirizzo Fornitura",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.billing_address,"onUpdate:modelValue":t[5]||(t[5]=e=>o.contractStore.newContract.billing_address=e),label:"Indirizzo Fatturazione",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.client_code,"onUpdate:modelValue":t[6]||(t[6]=e=>o.contractStore.newContract.client_code=e),label:"Codice Cliente",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.contract_name,"onUpdate:modelValue":t[7]||(t[7]=e=>o.contractStore.newContract.contract_name=e),label:"Nome Contratto",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.contract_code,"onUpdate:modelValue":t[8]||(t[8]=e=>o.contractStore.newContract.contract_code=e),label:"Codice Contratto",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.consumption_since_start,"onUpdate:modelValue":t[9]||(t[9]=e=>o.contractStore.newContract.consumption_since_start=e),label:"Consumo Totale",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.power_available,"onUpdate:modelValue":t[10]||(t[10]=e=>o.contractStore.newContract.power_available=e),label:"Potenza Disponibile",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.supply_start_date,"onUpdate:modelValue":t[11]||(t[11]=e=>o.contractStore.newContract.supply_start_date=e),label:"Data Inizio",type:"date",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.contract_end_date,"onUpdate:modelValue":t[12]||(t[12]=e=>o.contractStore.newContract.contract_end_date=e),label:"Data Fine",type:"date",class:"q-mb-md"},null,8,["modelValue"]),a(l,{modelValue:o.contractStore.newContract.billing_frequency,"onUpdate:modelValue":t[13]||(t[13]=e=>o.contractStore.newContract.billing_frequency=e),label:"Frequenza Fatturazione",class:"q-mb-md"},null,8,["modelValue"])]),_:1}),a(D,{align:"right"},{default:n(()=>[a(p,{flat:"",label:"Annulla",color:"negative",onClick:t[14]||(t[14]=e=>o.contractStore.closeDialog())}),a(p,{label:"Salva",color:"primary",onClick:d.saveContract},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const G=S(I,[["render",A]]);export{G as default};
